<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace = "FleaGoodsSUDAO">

	<!-- 전체 리스트 조회 -->
	<select id="fleaGoodsListAll" parameterType="fleaGoodsSU" resultType="fleaGoodsSU">
	<![CDATA[ SELECT *
    FROM (
        SELECT
            f.f_code, f.f_date, f.f_redate, f.f_sum, f.f_pname, f.f_spname, f.f_ppath, f.f_psize, f.f_content, f.f_ck, f.f_num, f.s_id, cs.cates_code, cs.cates_name,
             cm.catemm_name, c.catem_name 
        FROM
            flea f, cate_sub cs, cate_mid cm, cate_main c
        WHERE
            f.s_id = #{s_id}
            AND f.cates_code = cs.cates_code
            AND cs.catemm_code = cm.catemm_code
            AND cm.catem_code = c.catem_code
        ORDER BY
            f.f_date DESC
    )
    WHERE ROWNUM <= 10 ]]>
	</select>
	
	<!-- 수정 리스트 조회 -->
	<select id="getFleaInfo" parameterType="fleaGoodsSU" resultType="fleaGoodsSU">
	
		SELECT
            f.f_code, f.f_date, f.f_redate, f.f_sum, f.f_pname, f.f_spname, f.f_ppath, 
            f.f_psize, f.f_content, f.f_ck, f.f_num, f.s_id, cs.cates_code, cs.cates_name,
             cm.catemm_name, c.catem_name 
        FROM
            flea f, cate_sub cs, cate_mid cm, cate_main c
        WHERE
            f_code = #{f_code}
            AND f.cates_code = cs.cates_code
            AND cs.catemm_code = cm.catemm_code
            AND cm.catem_code = c.catem_code
	
	</select>
	
	<!-- 리스트 수정 -->
	<update id="modifyGoodsSU" parameterType="fleaGoodsSU">
	 UPDATE flea
		SET 
		    f_redate = sysdate,
		    cates_code = (SELECT cates_code FROM cate_sub WHERE cates_name = #{cates_name}),
		    f_sum = #{f_sum},
		    f_content = #{f_content},
		    f_num = #{f_num}
		WHERE f_code = #{f_code} and s_id=#{s_id}
		
		    <!-- f_pname = #{f_pname},
		    f_spname = #{f_spname},
		    f_ppath = #{f_ppath},
		    f_psize = #{f_psize},
		    f_ck = #{f_ck}, -->
		
	</update>
	
	<delete id="deleteGoodsSU" parameterType="fleaGoodsSU">
	
		 DELETE FROM flea WHERE f_code = #{f_code} 
	
	</delete>
	




</mapper>